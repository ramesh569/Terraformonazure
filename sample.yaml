# Dummy values to satisfy Helm schema validation

splunkObservability:
  accessToken: "${SPLUNK_OBSERVABILITY_ACCESS_TOKEN}"
  realm: "eu0"
splunkPlatform:
  endpoint: https://splunk.sharedagents.meso.local:8088/services/collector/event
  token: "${SPLUNK_PLATFORM_HEC_TOKEN}"
  index: "azu_azdoagents_n"
  insecureSkipVerify: true
  

# splunkPlatform:
#   endpoint: "http://otelgateway-splunk-otel-collector.splunk-gateway.svc.cluster.local:4317"
#   token: "dummy"
agent:
  enabled: false
gateway:
  enabled: false
clusterReceiver:
  enabled: true
  config:
    exporters:
      signalfx:
        access_token: "${SPLUNK_OBSERVABILITY_ACCESS_TOKEN}"
        api_url: https://api.eu0.signalfx.com
        ingest_url: https://ingest.eu0.signalfx.com
        sync_host_metadata: true
        correlation:
      splunk_hec:
        endpoint: https://splunk.sharedagents.meso.local:8088/services/collector/event
        token: "${SPLUNK_PLATFORM_HEC_TOKEN}"  
        source: "otel-cluster-receiver"
        sourcetype: "_json"
        index: "azu_azdoagents_n"
        profile: logs
        tls:
          insecure_skip_verify: true
        telemetry:
          enabled: true
        retry_on_failure:
          enabled: true
          initial_interval: 5s
          max_interval: 30s
          max_elapsed_time: 300s
        sending_queue:
          enabled: true
          num_consumers: 4
          queue_size: 512
      debug:
        verbosity: detailed
    receivers:
      otlp:
        protocols:
          grpc:
            endpoint: 0.0.0.0:4317
          http:
            endpoint: 0.0.0.0:4318
      k8s_cluster:
        auth_type: serviceAccount
        metadata_exporters: []  # Remove SignalFx metadata exporter
      prometheus/k8s_cluster_receiver:
        config:
          scrape_configs:
          - job_name: otel-k8s-cluster-receiver
            scrape_interval: 10s
            static_configs:
            - targets:
              - localhost:8899
    processors:
      batch: {}
      memory_limiter:
        check_interval: 2s
        limit_mib: ${SPLUNK_MEMORY_LIMIT_MIB}
      resource/add_collector_k8s:
        attributes:
        - action: insert
          key: k8s.node.name
          value: ${K8S_NODE_NAME}
        - action: insert
          key: k8s.pod.name
          value: ${K8S_POD_NAME}
        - action: insert
          key: k8s.namespace.name
          value: ${K8S_NAMESPACE}
      resourcedetection:
        detectors: [env, system]
        override: true
        timeout: 15s

    service:
      telemetry:
        logs:
          level: debug
      pipelines:
        metrics:
          receivers: [otlp]
          processors: [batch]
          exporters: [signalfx]
        logs:
          receivers: [otlp]
          processors: [batch]
          exporters: [splunk_hec, debug]
